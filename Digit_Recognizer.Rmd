---
title: "Handwritten Degits"
output:
  html_notebook:
    toc: true
    toc_float: true
---

#Good Reference
http://rstudio-pubs-static.s3.amazonaws.com/6287_c079c40df6864b34808fa7ecb71d0f36.html

#Load Libraries
Ok...
There are quite a few (not going to use all I guess)!

```{r}
library("RColorBrewer")
library("ElemStatLearn")
library("foreign")
library("tree")
library("RWeka")
library("rpart")
library("maptree")
library("e1071")
library(tidyverse)
library(psych)
```

#Load Data
Since the data is quite big, let's take 1000 samples from the data set.
Strictly speaking, it is proffered to have the same probability to be chosen (1/10) but let's ignore this bit.
At the same time, Digit indicators are created (there is a better way).

```{r}
Train.df <- read.csv(#"C:/Users/key_a/Desktop/Digit Recognizer/train.csv",
                     file.choose(),
                     header = T) %>% 
  sample_n(., 2000) %>% 
  mutate(label = factor(label))
Train.df2 <- Train.df %>%
  mutate(Digit0 = if_else(label == 0, 1, 0),
         Digit1 = if_else(label == 1, 1, 0),
         Digit2 = if_else(label == 2, 1, 0),
         Digit3 = if_else(label == 3, 1, 0),
         Digit4 = if_else(label == 4, 1, 0),
         Digit5 = if_else(label == 5, 1, 0),
         Digit6 = if_else(label == 6, 1, 0),
         Digit7 = if_else(label == 7, 1, 0),
         Digit8 = if_else(label == 8, 1, 0),
         Digit9 = if_else(label == 9, 1, 0))
head(Train.df)
```

#Exploratory analysis
We didn't really cover this in the previous sessions but it is always good to explore what we have!

##Summary Check
```{r}
summary(Train.df)
```

##Missing Value Check
Remember, data is messy in the real world!

```{r}
sum(is.na(Train.df))
```



#Plot
Any bias in the data?

```{r}
barplot(table(Train.df$label))
```

Seems fine!
There are about the same number of digits.

#Model
Logistic for... 3?

```{r}
Train.fit <- glm(Digit3 ~ ., family = "binomial", maxit = 25, data = Train.df %>% select(Digit3, starts_with("pixel")), control = list(trace=TRUE))
table(Predict = data.frame(Predict = if_else(predict(glm(Digit3 ~ ., family = "binomial", maxit = 25, data = Train.df %>% select(Digit3, starts_with("pixel")), control = list(trace=TRUE)), type = "response")
                                             >0.5, 1, 0), Actual = Train.df$Digit3)$Predict,
      Actual = data.frame(Predict = if_else(predict(glm(Digit3 ~ ., family = "binomial", maxit = 25, data = Train.df %>% select(Digit3, starts_with("pixel")), control = list(trace=TRUE)), type = "response")
                                             >0.5, 1, 0), Actual = Train.df$Digit3)$Actual)
```


#k Means Clustering?
```{r}

pc <- proc.time()
model.rpart <- rpart(label ~ ., method = "class", data = Train.df)
proc.time() - pc
printcp(model.rpart)
plot(model.rpart, uniform = TRUE, main = "Classification (RPART). Tree of Handwritten Digit Recognition ")
text(model.rpart, all = TRUE, cex = 0.75)
```
